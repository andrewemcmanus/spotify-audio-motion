<h2>Profile Page</h2>

<h3>List your favorites:</h3>
<% for (i=0; i < favorites.length; i++) { %>
  <h3><%= favorites[i] %></h3>
<% } %>

<header>
  <h1><a href="https://audiomotion.dev" class="logo">audioMotion-analyzer</a> | minimal demo</h1>
  <ul class="header-nav">
    <li><a href="index.html">Demos</a></li>
          <li><a href="https://audiomotion.dev">Home</a></li>
    <li><a href="https://github.com/hvianna/audioMotion-analyzer/tree/master/demo/src/fluid.js">View on GitHub</a></li>
  </ul>
</header>

<div id="container"></div>
<audio id="audio" src="<%= track.preview_url %>" controls crossorigin="anonymous"></audio>

<div class="box center">
  <button id="btn_fullscreen">Fullscreen</button>
</div>
<h5 class="genre">Give it a genre:</h5>
    <form id="update" action="/profile/<%= result.id %>?_method=PUT" method="POST">
      <input type="text" name="id" value="<%= genre.id %>" hidden> <!--this will desplay Name for the input and-->
      edit: <input class="text" type="text" name="content" value="<%= genre.genre %>">
      <input type="text" name="songId" value="<%= result.id %>" hidden>

      <button class="text" type="submit">Submit</button>
    </form>
  </div>
    <form  action="/profile/<%= genre.id %>?_method=DELETE" method="POST">
      <input type="text" name="songId" id="songId" value="<%= result.id %>"hidden>
      <button class="text" type="submit">DELETE</button>
    </form>

<div class="credits">
  <strong>audioMotion-analyzer v<span id="version"></span></strong> Copyright &copy; 2018-2020 Henrique Avila Vianna.	Source code available on <a href="https://github.com/hvianna/audioMotion-analyzer">GitHub</a>.
  Live stream: <a href="https://federalfm.ufpel.edu.br">RÃ¡dio Federal FM</a>.
</div>

<script type="module">
  import AudioMotionAnalyzer from 'https://cdn.skypack.dev/audiomotion-analyzer?min';


  try {
    var audioMotion = new AudioMotionAnalyzer(
      document.getElementById('container'),
      {
        source: document.getElementById('audio'),
        // set your preferred options here
      }
    );
  }

  catch( err ) {
    document.getElementById('container').innerHTML = `<p>audioMotion-analyzer failed with error: <em>${err}</em></p>`;
  }

  if ( audioMotion ) {
    // Resume audio context if in suspended state (browsers' autoplay policy)
    window.addEventListener( 'click', () => {
      if ( audioMotion.audioCtx.state == 'suspended' )
        audioMotion.audioCtx.resume();
    });

    // Display package version in the footer
    document.getElementById('version').innerText = audioMotion.version;

    // Handle fullscreen button
    document.getElementById('btn_fullscreen').addEventListener( 'click', () => audioMotion.toggleFullscreen() );
  }
</script>

<script>
  if ( location.href.startsWith('file://') )
    alert("This demo won't work when loaded via file:// protocol.\nSee the README file inside the demo folder for more information.");
</script>
